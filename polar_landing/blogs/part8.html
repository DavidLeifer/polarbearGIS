<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.0.3.1 (MacOSX)"/>
	<meta name="created" content="2021-01-09T14:13:59.992187704"/>
	<meta name="changed" content="2021-06-28T20:08:02.732677395"/>
	<style type="text/css">
		@page { size: 8.5in 11in; margin: 0.79in }
		p { margin-bottom: 0.1in; line-height: 115%; background: transparent }
		h3 { margin-top: 0.1in; margin-bottom: 0.08in; background: transparent; page-break-after: avoid }
		h3.western { font-family: "Liberation Serif", serif; font-size: 14pt; font-weight: bold }
		h3.cjk { font-family: "Songti SC"; font-size: 14pt; font-weight: bold }
		h3.ctl { font-family: "Arial Unicode MS"; font-size: 14pt; font-weight: bold }
		pre { font-family: "Liberation Mono", monospace; font-size: 10pt; background: transparent }
		strong { font-weight: bold }
		a:link { color: #000080; so-language: zxx; text-decoration: underline }
		a:visited { color: #800000; so-language: zxx; text-decoration: underline }
	</style>
</head>
<body lang="en-US" link="#000080" vlink="#800000" dir="ltr"><h3 class="western">
Part 8: Displaying Raster Correlation with npm, Open Layers,
and&nbsp;parcel</h3>
<p><br/>
<br/>

</p>
<p><strong>Plug</strong> to <a href="http://nhuthehoang.com/" target="_blank">http://nhuthehoang.com/</a>
for telling me about GCP and Geoserver.</p>
<p>This series is me chronicling my adventure making a data pipeline.
This pipe is outlined on GitHub here in the readme:
<a href="https://gitlab.com/davleifer/polarbearGIS">https://gitlab.com/davleifer/polarbearGIS</a></p>
<p><strong>Part </strong><strong>1</strong><strong>:
</strong><strong><a href="https://www.davidjleifer.com/blogs/part1.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part</span></u></span></font></a></strong><strong><a href="https://www.davidjleifer.com/blogs/part1.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">1</span></u></span></font></a></strong><strong><a href="https://www.davidjleifer.com/blogs/part1.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">.html</span></u></span></font></a></strong></p>
<p><strong>Part 2: </strong><strong><a href="https://www.davidjleifer.com/blogs/part2.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part2.html</span></u></span></font></a></strong></p>
<p><strong>Part 3:</strong>
<strong><a href="https://www.davidjleifer.com/blogs/part3.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part3.html</span></u></span></font></a></strong></p>
<p><strong>Part 4: </strong><strong><a href="https://www.davidjleifer.com/blogs/part4.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part4.html</span></u></span></font></a></strong></p>
<p><strong>Part 5: </strong><strong><a href="https://www.davidjleifer.com/blogs/part5.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part5.html</span></u></span></font></a></strong></p>
<p><strong>Part 6: </strong><a href="https://www.davidjleifer.com/blogs/part6.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/part6.html</u></span></font></a></p>
<p><strong>Part </strong><strong>7</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part7.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/part7.html</u></span></font></a></p>
<p><strong>Part </strong><strong>9</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part9.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/part9.html</u></span></font></a></p>
<p><strong>Part </strong><strong>1</strong><strong>0</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/par</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>t1</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>0</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>.html</u></span></font></a></p>
<p><strong>Part </strong><strong>1</strong><strong>1</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/par</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>t1</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>1</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>.html</u></span></font></a></p>
<p><b>Part 12: </b><a href="https://www.davidjleifer.com/blogs/part12.html"><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part12.html</span></a></p>
<p><b>Part 13: </b><a href="https://www.davidjleifer.com/blogs/part13.html"><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part13.html</span></a></p>
<p><b>Part 14: </b><a href="https://www.davidjleifer.com/blogs/part14.html"><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part14.html</span></a></p>
<p style="font-weight: normal"><br/>
<br/>

</p>
<p>We’re gonna use ol.ext! It was a cool little library that uses
Open Layers and has a ton of functionality. Looks like a hobby
project that doesn’t get much love lately, I wonder what the french
man is up to. NPM actually can’t even install the normal version of
ol.ext without vulnerabilities, but we can use it with parcel and it
builds with 0 vulnerabilities. Which is nice. I mean this data is
super public but I don’t want vulnerabilities. And yes I know
sharing my port and external ip address looks dumb this is for
learning science!</p>
<p>Basically this is based on
<a href="https://github.com/Viglino/ol-ext-parcel-bundler" target="_blank">https://github.com/Viglino/ol-ext-parcel-bundler</a>.</p>
<p>But the general idea is that you can click the layers after
clicking a button, and there goes the correlation layers. Not as cool
as a timeslider, but this is hobby programming lol you get what you
pay for!</p>
<p>First download the data onto the www folder of the Geoserver
webserver we set up in Part 1 of this series.</p>
<pre style="margin-bottom: 0.2in">sudo wget --load-cookies /tmp/cookies.txt &quot;<a href="https://docs.google.com/uc?export=download&amp;confirm=$%28wget" target="_blank">https://docs.google.com/uc?export=download&amp;confirm=$(wget</a> --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate '<a href="https://docs.google.com/uc?export=download&amp;id=1ZIhsD2gGwP-i7eKD8hnOX-BepofbCRiy%27" target="_blank">https://docs.google.com/uc?export=download&amp;id=1ZIhsD2gGwP-i7eKD8hnOX-BepofbCRiy'</a> -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&amp;id=1ZIhsD2gGwP-i7eKD8hnOX-BepofbCRiy&quot; -O xyz-timeseries-data &amp;&amp; rm -rf /tmp/cookies.txt</pre><p>
All we really do is change the /js/layer/layers.js file to this:</p>
<pre>/** Add layers to the map
 */
import map from '../map';
import TileLayer from 'ol/layer/Tile.js';
import OSM from 'ol/source/OSM';
import LayerGroup from 'ol/layer/Group'
import View from 'ol/View';
import XYZ from 'ol/source/XYZ';
const year1981 = new TileLayer({
    title: '1981 Jan Correlation',
    source: new XYZ({
    url: &quot;<a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1981/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">http://XX.XXX.XXX.XXX:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1981/{z}/{x}/{y}.png</a>&quot;,
    }),
});
const year1991 = new TileLayer({
    title: '1991 Jan Correlation',
    source: new XYZ({
    url: &quot;<a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1991/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">http://</a><a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1981/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">XX.XXX.XXX.XXX</a><a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1991/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1991/{z}/{x}/{y}.png</a>&quot;,
    }),
});
const year2001 = new TileLayer({
    title: '2001 Jan Correlation',
    source: new XYZ({
    url: &quot;<a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_2001/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">http://</a><a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1981/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">XX.XXX.XXX.XXX</a><a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_2001/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_2001/{z}/{x}/{y}.png</a>&quot;,
    }),
});
const year2011 = new TileLayer({
    title: '2011 Jan Correlation',
    source: new XYZ({
    url: &quot;<a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_2011/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">http://</a><a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_1981/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">XX.XXX.XXX.XXX</a><a href="http://35.239.133.210:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_2011/%7Bz%7D/%7Bx%7D/%7By%7D.png" target="_blank">:8080/geoserver/www/xyz-ol-ext/ppt_cor_xyz/ppt_cor_xyz_ppt_pearson_final_2011/{z}/{x}/{y}.png</a>&quot;,
    }),
});
/* OSM layer */
const osm = new TileLayer({
    title: 'OSM',
    source: new OSM()
});
/* Add to map */
map.addLayer(osm);
map.addLayer(year1981);
map.addLayer(year1991);
map.addLayer(year2001);
map.addLayer(year2011);
export {year1981, year1991, year2001, year2011, osm}</pre><p>
First make a directory in base directory of your GCP.</p>
<pre>sudo mkdir pandamoniumGIS20210109
cd pandamoniumGIS20210109</pre><p>
Then upload the pandamoniumGIS package to google drive and download
into the base directory of your GCP.</p>
<pre style="margin-bottom: 0.2in">sudo wget --load-cookies /tmp/cookies.txt &quot;<a href="https://docs.google.com/uc?export=download&amp;confirm=$%28wget" target="_blank">https://docs.google.com/uc?export=download&amp;confirm=$(wget</a> --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate '<a href="https://docs.google.com/uc?export=download&amp;id=1cEW58M4kbkp5g0MXQJgsO65TCfCaMxcD%27" target="_blank">https://docs.google.com/uc?export=download&amp;id=1cEW58M4kbkp5g0MXQJgsO65TCfCaMxcD'</a> -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&amp;id=1cEW58M4kbkp5g0MXQJgsO65TCfCaMxcD&quot; -O xyz-timeseries-data &amp;&amp; rm -rf /tmp/cookies.txt</pre><p>
Unzip.</p>
<pre style="margin-bottom: 0.2in">sudo unzip xyz-timeseries-data</pre><p>
Go into unzipped directory.</p>
<pre style="margin-bottom: 0.2in">cd pandamoniumGIS20210109_v2</pre><p>
We update npm, initialize npm, install ol, install ol-ext and install
parcel bundler.</p>
<pre>sudo npm install -g npm@latest
sudo npm init
sudo npm install ol
sudo npm install -g parcel-bundler
sudo npm install ol-ext</pre><p>
Then fire it up.</p>
<pre style="margin-bottom: 0.2in">sudo npm start</pre><p>
Point browser to:</p>
<pre style="margin-bottom: 0.2in"><a href="http://34.72.131.193:1234/" target="_blank">http://XX.XX.XXX.XXX:1234/</a></pre><p>
If you’re having trouble getting it to go to port 1234 like I was,
use this to see processes running:</p>
<pre style="margin-bottom: 0.2in">ps -ef | grep node</pre><p>
Then kill them! Process_ID is second column from the left in Ubuntu.</p>
<pre style="margin-bottom: 0.2in">sudo kill -9 [process_ID]</pre>
<hr/>

<p><strong>Plug</strong> to <a href="http://nhuthehoang.com/" target="_blank">http://nhuthehoang.com/</a>
for telling me about GCP and Geoserver.</p>
<p>This series is me chronicling my adventure making a data pipeline.
This pipe is outlined on GitHub here in the readme:
<a href="https://gitlab.com/davleifer/polarbearGIS">https://gitlab.com/davleifer/polarbearGIS</a></p>
<p><strong>Part </strong><strong>1</strong><strong>:
</strong><strong><a href="https://www.davidjleifer.com/blogs/part1.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part</span></u></span></font></a></strong><strong><a href="https://www.davidjleifer.com/blogs/part1.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">1</span></u></span></font></a></strong><strong><a href="https://www.davidjleifer.com/blogs/part1.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">.html</span></u></span></font></a></strong></p>
<p><strong>Part 2: </strong><strong><a href="https://www.davidjleifer.com/blogs/part2.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part2.html</span></u></span></font></a></strong></p>
<p><strong>Part 3:</strong>
<strong><a href="https://www.davidjleifer.com/blogs/part3.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part3.html</span></u></span></font></a></strong></p>
<p><strong>Part 4: </strong><strong><a href="https://www.davidjleifer.com/blogs/part4.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part4.html</span></u></span></font></a></strong></p>
<p><strong>Part 5: </strong><strong><a href="https://www.davidjleifer.com/blogs/part5.html"><font color="#000080"><span lang="zxx"><u><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part5.html</span></u></span></font></a></strong></p>
<p><strong>Part 6: </strong><a href="https://www.davidjleifer.com/blogs/part6.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/part6.html</u></span></font></a></p>
<p><strong>Part </strong><strong>7</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part7.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/part7.html</u></span></font></a></p>
<p><strong>Part </strong><strong>9</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part9.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/part9.html</u></span></font></a></p>
<p><strong>Part </strong><strong>1</strong><strong>0</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/par</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>t1</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>0</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part10.html"><font color="#000080"><span lang="zxx"><u>.html</u></span></font></a></p>
<p><strong>Part </strong><strong>1</strong><strong>1</strong><strong>:
</strong><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>https://www.davidjleifer.com/blogs/par</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>t1</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>1</u></span></font></a><a href="https://www.davidjleifer.com/blogs/part11.html"><font color="#000080"><span lang="zxx"><u>.html</u></span></font></a></p>
<p><b>Part 12: </b><a href="https://www.davidjleifer.com/blogs/part12.html"><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part12.html</span></a></p>
<p><b>Part 13: </b><a href="https://www.davidjleifer.com/blogs/part13.html"><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part13.html</span></a></p>
<p><b>Part 14: </b><a href="https://www.davidjleifer.com/blogs/part14.html"><span style="font-weight: normal">https://www.davidjleifer.com/blogs/part14.html</span></a></p>
</body>
</html>